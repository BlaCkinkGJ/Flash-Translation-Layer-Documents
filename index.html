<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Flash Translation Layer: Flash Translation Layer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Flash Translation Layer
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Flash Translation Layer </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Overview</h2>
<p>This repository contains the simple Flash Translation Layers made on the Linux Environments.</p>
<p>Furthermore, this repository not only works on the ramdisk but also works on various devices(e.g. Zoned Block Device, and bluedbm, etc.).</p>
<p>If you have any questions about this project, please contact the maintainer (<a href="#" onclick="location.href='mai'+'lto:'+'ss5'+'ki'+'jun'+'@g'+'mai'+'l.'+'com'; return false;">ss5ki<span style="display: none;">.nosp@m.</span>jun@<span style="display: none;">.nosp@m.</span>gmail<span style="display: none;">.nosp@m.</span>.com</a>).</p>
<h2>Build</h2>
<blockquote class="doxtable">
<p>These instructions based on the Ubuntu(&gt;=16.04) environments </p>
</blockquote>
<h3>Prerequisite</h3>
<p>Before you build this repository, you must install some packages from the package manager.</p>
<div class="fragment"><div class="line">sudo apt update -y</div><div class="line">sudo apt install -y git make gcc g++ libglib2.0-dev</div></div><!-- fragment --><p>After you download the packages you must receive this project code by using <code>git clone</code> like below.</p>
<div class="fragment"><div class="line">git clone --recursive ${REPOSITORY_URL}</div></div><!-- fragment --><p>Now you move to this repository's project directory root by using <code>mv</code>.</p>
<blockquote class="doxtable">
<p>If you want to use a module like Zoned Block Device module, you must set the value of the <code>USE_ZONE_DEVICE</code> variable to 1 in the <code>Makefile</code>. </p>
</blockquote>
<p>Additionally, you must install a valid library for each module. Each module's requirements are as follows.</p>
<ul>
<li>zone: <a href="https://github.com/westerndigitalcorporation/libzbd">libzbd</a></li>
<li>bluedbm: <a href="https://github.com/pnuoslab/Flash-Board-Tester">libmemio</a></li>
</ul>
<blockquote class="doxtable">
<p>Moreover, before you run the Zoned Block Device-based program, You must check that you give the super-user privileges to run the Zoned Block Device-based programs. </p>
</blockquote>
<h3>Test</h3>
<p>If you want to generate test files, execute the below command.</p>
<div class="fragment"><div class="line">make clean &amp;&amp; make -j$(nproc) test</div></div><!-- fragment --><p>After the build finish, you can get the various test files from the results. Run those files to test the project's module works correctly.</p>
<h3>Execution</h3>
<p>If you want to generate a release program through the <code><a class="el" href="main_8c.html" title="main program for test the interface ">main.c</a></code>, then you must execute the below commands.</p>
<div class="fragment"><div class="line">make clean &amp;&amp; make -j$(nproc)</div></div><!-- fragment --><p>Now, you can run that program by using <code>./a.out</code></p>
<h2>How to use this project</h2>
<p>You can easily use this program like below. This program writes the random data into 10 segments. And read from each segment written data. Also, do garbage collection after the number of write to the segments is the multiplication of 5.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;assert.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="module_8h.html">include/module.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="flash_8h.html">include/flash.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="page_8h.html">include/page.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="log_8h.html">include/log.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="device_8h.html">include/device.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="main_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a>(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">        <span class="keyword">struct </span><a class="code" href="structflash__device.html">flash_device</a> *flash = NULL;</div><div class="line">        <span class="keywordtype">char</span> buffer[8192];</div><div class="line">        assert(0 == <a class="code" href="module_8h.html#aa7056e5ec4f318608f8912edcd18085c">module_init</a>(<a class="code" href="module_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2da7f784eaff0d1e03f9ddc19e27d9b40fe">PAGE_FTL_MODULE</a>, &amp;flash, <a class="code" href="device_8h.html#a99fb83031ce9923c84392b4e92f956b5af76728a97eb3a7ea54c40f08a19aec50">RAMDISK_MODULE</a>));</div><div class="line">        <a class="code" href="log_8h.html#a6683b82f55e7ea04acdc8e2159fe5cbf">pr_info</a>(<span class="stringliteral">&quot;module initialize\n&quot;</span>);</div><div class="line">        flash-&gt;<a class="code" href="structflash__device.html#a497f2e0ba2708bdde1d8a1d15f8dd2cb">f_op</a>-&gt;<a class="code" href="structflash__operations.html#abd2d025ed3e5d06595c44ae5cde9710d">open</a>(flash, NULL, O_CREAT | O_RDWR);</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 8192 * 10; i++) {</div><div class="line">                <span class="keywordtype">int</span> num;</div><div class="line">                <span class="keywordtype">size_t</span> sector;</div><div class="line">                num = i * 2;</div><div class="line">                memset(buffer, 0, 8192);</div><div class="line">                *(<span class="keywordtype">int</span> *)buffer = num;</div><div class="line">                sector = rand() % (1 &lt;&lt; 31);</div><div class="line">                flash-&gt;<a class="code" href="structflash__device.html#a497f2e0ba2708bdde1d8a1d15f8dd2cb">f_op</a>-&gt;<a class="code" href="structflash__operations.html#a0e715ff079b7e77e0da3ec4d53f94562">write</a>(flash, buffer, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), sector);</div><div class="line">                <a class="code" href="log_8h.html#a6683b82f55e7ea04acdc8e2159fe5cbf">pr_info</a>(<span class="stringliteral">&quot;write value: %d\n&quot;</span>, *(<span class="keywordtype">int</span> *)buffer);</div><div class="line">                memset(buffer, 0, 8192);</div><div class="line">                flash-&gt;<a class="code" href="structflash__device.html#a497f2e0ba2708bdde1d8a1d15f8dd2cb">f_op</a>-&gt;<a class="code" href="structflash__operations.html#a4003f9f7f49625fef20869e8e29013c1">read</a>(flash, buffer, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), sector);</div><div class="line">                <a class="code" href="log_8h.html#a6683b82f55e7ea04acdc8e2159fe5cbf">pr_info</a>(<span class="stringliteral">&quot;read value: %d\n&quot;</span>, *(<span class="keywordtype">int</span> *)buffer);</div><div class="line">                <span class="keywordflow">if</span> (i % 8192 * 5 == 0) {</div><div class="line">                        flash-&gt;<a class="code" href="structflash__device.html#a497f2e0ba2708bdde1d8a1d15f8dd2cb">f_op</a>-&gt;<a class="code" href="structflash__operations.html#aea1743a882769a52dcf44157a58ace76">ioctl</a>(flash, <a class="code" href="page_8h.html#abed82baf7f470b522273a3e37c24c600aee20bdc4d85ef6e72f4ed8af5161f776">PAGE_FTL_IOCTL_TRIM</a>);</div><div class="line">                }</div><div class="line">        }</div><div class="line">        flash-&gt;<a class="code" href="structflash__device.html#a497f2e0ba2708bdde1d8a1d15f8dd2cb">f_op</a>-&gt;<a class="code" href="structflash__operations.html#a3fa7e41fe095c9f88dc354f9f18cff63">close</a>(flash);</div><div class="line">        assert(0 == <a class="code" href="module_8h.html#ac1252483f54da2ed2d7006ce3831631d">module_exit</a>(flash));</div><div class="line">        <a class="code" href="log_8h.html#a6683b82f55e7ea04acdc8e2159fe5cbf">pr_info</a>(<span class="stringliteral">&quot;module deallcation\n&quot;</span>);</div><div class="line"></div><div class="line">        <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h2>How to get this project's documents</h2>
<p>You can get this program's documentation file by using <code>doxygen -s Doxyfile</code>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
